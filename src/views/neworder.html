
  <style>
    /* Contenedor personalizable */
    .contenedor-paciente {
      max-width: 1100px;
      margin-left: auto;
      margin-right: auto;
      padding: 0 15px;
    }

    /* Estilo visual de la tarjeta */
    .formulario-paciente {
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    /* Títulos y texto */
    .formulario-paciente h5 {
      font-size: 20px;
      font-weight: 600;
      color: #2d2d2d;
    }

    .formulario-paciente p {
      font-size: 14px;
      color: #6c757d;
      margin-bottom: 1.25rem;
    }

    /* Etiquetas */
    #newOrderForm .form-label,
    .formulario-paciente .form-label {
      font-weight: 500;
      font-size: 14px;
      margin-bottom: 0.25rem;
      color: #344767;
    }

    /* Inputs y selects generales (incluye date y time) */
    #newOrderForm input.form-control,
    #newOrderForm select.form-select,
    #fecha_creacion,
    #hora_creacion {
      background-color: #fff;
      color: #495057;
      border: 1px solid #ced4da;
      border-radius: 0.375rem;
      font-size: 14px;
      padding: 0.55rem 0.75rem;
      transition: border-color 0.2s ease-in-out, box-shadow 0.2s;
      appearance: none;
    }

    /* Enfocados */
    #newOrderForm input.form-control:focus,
    #newOrderForm select.form-select:focus,
    #fecha_creacion:focus,
    #hora_creacion:focus {
      border-color: #5e72e4;
      box-shadow: 0 0 0 0.15rem rgba(94, 114, 228, 0.25);
    }

    /* Selects con flechita */
    #newOrderForm select.form-select {
      padding-inline-end: 2rem;
      background-position: right 1rem center;
      background-repeat: no-repeat;
      background-size: 10px;
    }

    /* Espaciado entre columnas */
    #newOrderForm .row.g-3>[class*='col'],
    .formulario-paciente .row.g-3>[class*='col'] {
      padding-left: 10px;
      padding-right: 10px;
    }

    /* Botón */
    #newOrderForm .text-end.mt-4 {
      margin-top: 1.5rem;
      padding-right: 1.2rem;
    }

    #newOrderForm .btn {
      padding: 0.5rem 1.2rem;
      font-size: 15px;
    }

    /* Responsive ajustes */
    @media (max-width: 768px) {
      #newOrderForm .text-end.mt-4 {
        text-align: center !important;
        padding-right: 0;
      }

      #newOrderForm .btn {
        width: 100%;
        margin-bottom: 10px;
      }
    }

    #cedula {
      width: 100%;
      /* Puedes cambiar a 80%, 300px, etc. según necesites */
      padding: 0.55rem 0.75rem;
      font-size: 14px;
      border-radius: 0.375rem;
      border: 1px solid #ced4da;
      background-color: #fff;
      color: #495057;
      transition: border-color 0.2s ease-in-out, box-shadow 0.2s;
      height: 45px;
    }

    #cedula:focus {
      border-color: #5e72e4;
      box-shadow: 0 0 0 0.15rem rgba(94, 114, 228, 0.25);
    }

    /* Opcional: espacio extra si deseas separar del botón */
    #btnBuscarPaciente {
      height: 43px;
      min-width: 42px;
      /* Tamaño mínimo para que se vea bien */
    }

    #fecha_nacimiento {
      width: 100%;
      padding: 0.55rem 0.75rem;
      font-size: 14px;
      border-radius: 0.375rem;
      border: 1px solid #ced4da;
      background-color: #fff;
      color: #495057;
      transition: border-color 0.2s ease-in-out, box-shadow 0.2s;
      height: 45px;
    }

    #fecha_nacimiento:focus {
      border-color: #5e72e4;
      box-shadow: 0 0 0 0.15rem rgba(94, 114, 228, 0.25);
    }

    #btnBuscarPorFecha {
      height: 43px;
      min-width: 42px;
    }

    /* Contenedor de la tabla para scroll horizontal si se desborda */
    #tablaExamenesSeleccionados {
      width: 100%;
      overflow-x: auto;
    }

    /* Estilo general de la tabla */
    #tablaExamenesSeleccionados table {
      width: 100%;
      border-collapse: collapse;
      table-layout: auto;
    }

    /* Cabecera de la tabla */
    #tablaExamenesSeleccionados thead th {
      white-space: nowrap;
      text-align: center;
      font-size: 13px;
      font-weight: 600;
      color: #6c757d;
      padding: 10px;
      border-bottom: 1px solid #dee2e6;
    }

    /* Celdas del cuerpo */
    #tablaExamenesSeleccionados tbody td {
      vertical-align: middle;
      text-align: center;
      font-size: 14px;
      padding: 8px;
      word-wrap: break-word;
      max-width: 200px;
    }

    /* Botón Agregar / Eliminar */
    #tablaExamenesSeleccionados button {
      font-size: 13px;
      padding: 4px 10px;
    }

    /* Limitar ancho y hacer que el contenido largo se ajuste o corte elegantemente */
    #tablaExamenesSeleccionados td {
      white-space: nowrap;
      /* Mantiene el texto en una línea */
      overflow: hidden;
      /* Oculta lo que se sale */
      text-overflow: ellipsis;
      /* Muestra '...' si se sale */
      max-width: 180px;
      /* Ajusta según tu diseño */
    }

    /* Especialmente útil para la columna de indicaciones */
    #tablaExamenesSeleccionados td:nth-child(5) {
      max-width: 220px;
      /* Ajusta si tus textos son largos */
      white-space: normal;
      /* Permite salto de línea si prefieres */
      word-wrap: break-word;
      /* Rompe palabras largas */
    }

    /* Estilo general del dropdown */
    .dropdown-menu {
      display: block;
      position: absolute;
      z-index: 9999;
      background-color: #ffffff;
      border: 1px solid #ced4da;
      border-radius: 0.375rem;
      max-height: 200px;
      overflow-y: auto;
      padding: 0;
      margin-top: 0.2rem;
      font-size: 14px;
      width: 100%;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);
    }

    /* Estilo de cada item del dropdown */
    .dropdown-menu li {
      padding: 10px 15px;
      cursor: pointer;
      color: #333;
      white-space: nowrap;
    }

    /* Hover del item */
    .dropdown-menu li:hover {
      background-color: #f1f3f5;
      color: #212529;
      font-weight: 500;
    }

    /* Estilo si está seleccionado (opcional, puedes añadirlo dinámicamente) */
    .dropdown-menu li.active {
      background-color: #5e72e4;
      color: white;
    }

    .dropdown-menu:empty {
      display: none !important;
      border: none !important;
    }

    .fila-total {
      background-color: transparent;
      /* Sin fondo */
    }

  </style>


    <!-- SECCIÓN: Datos del paciente - NUEVA ORDEN -->
    <div class="contenedor-paciente mx-auto">
      <div class="card p-4 mb-4 formulario-paciente">
        <h5 class="mb-1 text-dark fw-bold"></h5>


        <!-- Fecha y hora de creación de la orden -->
        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label for="fecha_creacion" class="form-label">Fecha de creación</label>
            <input type="date" class="form-control" id="fecha_creacion" name="fecha_creacion" />
          </div>
          <div class="col-md-6">
            <label for="hora_creacion" class="form-label">Hora de creación</label>
            <input type="time" class="form-control" id="hora_creacion" name="hora_creacion" />
          </div>
        </div>

        <form id="newOrderForm">
          <div class="row g-3">
            <!-- Campo de Cédula con botón buscar -->
            <div class="col-md-6">
              <label for="cedula" class="form-label">Cédula</label>
              <div class="d-flex">
                <input type="text" class="form-control me-2" id="cedula" required />
                <button class="btn btn-dark" type="button" id="btnBuscarPaciente">
                  <i class="material-symbols-rounded align-middle">search</i>
                </button>
              </div>
            </div>

            <!-- Campo de Fecha de nacimiento con botón buscar por fecha -->
            <div class="col-md-6">
              <label for="fecha_nacimiento" class="form-label">Fecha de nacimiento</label>
              <div class="d-flex">
                <input type="date" class="form-control me-2" id="fecha_nacimiento" required />
                <button class="btn btn-dark" type="button" id="btnBuscarPorFecha">
                  <i class="material-symbols-rounded align-middle">search</i>
                </button>
              </div>
            </div>

            <div class="col-md-6">
              <label for="nombres" class="form-label">Nombres</label>
              <input type="text" class="form-control" id="nombres" required />
            </div>

            <div class="col-md-6">
              <label for="apellidos" class="form-label">Apellidos</label>
              <input type="text" class="form-control" id="apellidos" required />
            </div>

            <div class="col-md-6">
              <label for="sexo" class="form-label">Sexo</label>
              <select class="form-select" id="sexo" required>
                <option value="">Seleccione...</option>
              </select>
            </div>

            <div class="col-md-6">
              <label for="telefono" class="form-label">Teléfono</label>
              <input type="text" class="form-control" id="telefono" required />
            </div>

            <div class="col-md-6">
              <label for="correo" class="form-label">Correo electrónico</label>
              <input type="email" class="form-control" id="correo" required />
            </div>

            <div class="col-md-6">
              <label for="diagnostico" class="form-label">Diagnóstico</label>
              <input type="text" class="form-control" id="diagnostico" />
            </div>
          </div>

          <!-- SECCIÓN: Selección de exámenes -->
          <div class="card mt-5">
            <div class="card-header pb-0">
              <h6 class="text-dark fw-bold mb-0">Exámenes:</h6>

              <div class="row mt-4 g-2 position-relative">
                <!-- Input + Dropdown por Nombre -->
                <div class="col-md-6 position-relative">
                  <div class="input-group input-group-outline">
                    <input type="text" id="buscadorNombreExamen" class="form-control"
                      placeholder="Ej: Hemograma, Glucosa..." autocomplete="off">
                  </div>
                  <ul id="dropdownNombreResultados" class="dropdown-menu show w-100 mt-1"
                    style="position: absolute; z-index: 1000;"></ul>
                </div>
                <!-- Input + Dropdown por Código -->
                <div class="col-md-6 position-relative">
                  <div class="input-group input-group-outline">
                    <input type="text" id="buscadorCodigoExamen" class="form-control"
                      placeholder="Ej: HEM001, BIO002..." autocomplete="off">
                  </div>
                  <ul id="dropdownCodigoResultados" class="dropdown-menu show w-100 mt-1"
                    style="position: absolute; z-index: 1000;"></ul>
                </div>

                <div class="card-body px-3 pb-3">
                  <table id="tablaExamenesSeleccionados" class="table table-hover align-items-center mb-0 w-100">
                    <thead>
                      <tr>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Nombre</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Código</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Área</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Precio</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Indicaciones
                        </th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">
                          Opción</th>
                      </tr>
                    </thead>
                    <tbody id="examenTableBody">
                      <!-- Agregado dinámico con JS -->
                    </tbody>

                  </table>
                </div>
              </div>
            </div>
          </div>


          <!-- Botones -->
          <div class="d-flex justify-content-end gap-2 mt-4">
            <button id="btnGuardarOrden" type="button" class="btn btn-success">
              <i class="material-symbols-rounded align-middle">check</i> Guardar
            </button>
            <button id="btnLimpiarOrden" class="btn btn-outline-dark">
              <i class="material-symbols-rounded align-middle">restart_alt</i> Limpiar
            </button>
          </div>
      </div>
    </div>


  
  <script>
  window.jsPDF = window.jspdf.jsPDF;
</script>

  <script src="../js/neworder.js"></script>

